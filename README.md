# Паспорт шаблона разработки «Матрица согласования»
## Возможности решения
Позволяет гибко настроить список исполнителей этапа согласования. Пользователь решения создает записи в справочнике «Матрицы согласования» модуля «Расширение согласования по регламенту», указывает критерии матрицы: приоритет, вид документа, категорию договора, нашу организацию, подразделение, должность. А также заполняет список предполагаемых исполнителей. В необходимом этапе согласования исполнителем указывается роль согласования «Исполнители по матрице согласования». При вычислении исполнителей роли согласования система по согласуемому документу ищет подходящую по критериям запись справочника «Матрицы согласования» и возвращает указанных в записи исполнителей.
## Апробация на проектах
Реализованная функциональность была использована на проектах:
·	Проект 1 — Внедрение Directum RX в ООО Бионорика.
## Состав решения
1.	Модуль «Матрицы согласования» (MatrixCore).
2.	Модуль «Расширение согласования по регламенту» (ApprovalTaskExtensionUI).
3.	Тип справочника «Матрицы согласования» (ApprovalMatrix).
4.	Тип справочника «Роли согласования» (ApprovalRole). Новая роль согласования «Исполнители по матрице согласования».
5.	Перекрытие типа справочника «Этапы согласования» (ApprovalStage), модуля Документооборот (Docflow).
6.	Новая роль «Пользователи настраивающие матрицы согласования». При инициализации выдаются полные права на работу с модулем «Расширение согласования по регламенту», полные права на справочник «Матрицы согласования».
7.	Локализация новых элементов разработки.
## Варианты расширения функциональности на проектах
1.	Добавление новых ролей согласования для работы с матрицей согласования.
2.	Добавление новых полей для фильтрации по матрицам согласования.
3.	Изменение логики вычисления нашей организации, подразделения и должности сотрудника, указанного в документе в зависимости от вида и типа документа.
## Архитектурно неочевидные моменты
Сотрудник из документа, по которому происходит фильтрация матриц по свойствам «Наша организация», «Подразделение», «Должность», вычисляется по следующему алгоритму:
1. Для договорных документов сотрудник берется из свойства «Ответственный».
2. Для внутренних документов сотрудник берется из свойства «Подготовил».
3. Для исходящих документов сотрудник берется из свойства «Подготовил».
4. Для входящих документов сотрудник берется из свойства «Адресат».
5. Для остальных типов документов сотрудник берется из свойства «Автор».
Расчет приоритета матриц происходит по убыванию, т.е. чем больше число в свойстве «Приоритет», тем приоритетнее матрица.
